================================================================================
pg_sexp Benchmark Summary
Generated: dom 07 dic 2025 00:35:24 CET
Image: localhost/pg_sexp-production
================================================================================

## POSTGRESQL VERSION
PostgreSQL 18.1 on x86_64-pc-linux-musl, compiled by Alpine clang version 19.1.4, 64-bit

## STORAGE COMPARISON

 sexp  | 21 MB      | 20 MB      |     50000
 jsonb | 24 MB      | 23 MB      |     50000

 sexp  |           409
 jsonb |           481

## TIMING RESULTS

Test                                                                 Time (ms)
----------------------------------------------------------------- ------------
sexp: Inserting 50,000 rows                                            325.362
jsonb: Inserting 50,000 rows                                           318.274
sexp: Full table scan with COUNT                                         2.236
jsonb: Full table scan with COUNT                                        2.473
sexp: Full table scan with SUM of data length                           30.716
jsonb: Full table scan with SUM of data length                          40.770
sexp: Access first element (car)                                        12.426
jsonb: Access first-level key                                            4.018
sexp: Access nested element (nth 2 = user info)                          8.474
jsonb: Access nested element (user object)                               4.603
sexp: Deep nested access (user -> id) via car/cdr                       25.477
jsonb: Deep nested access (user -> id)                                   5.506
sexp @>>: Filter by settings.theme = dark (33% selectivity)             28.712
jsonb @>: Filter by settings.theme = dark (33% selectivity)              5.406
sexp @>>: Filter by user.id = 12345 (highly selective)                  29.334
jsonb @>: Filter by user.id = 12345 (highly selective)                   6.243
sexp @>>: Multi-condition (settings.theme=dark AND notifications=       25.380
jsonb @>: Multi-condition (settings.theme=dark AND notifications=        5.361
sexp @>: Find exact (theme "dark") sublist anywhere                     26.216
sexp @>: Find symbol alpha anywhere                                     25.239
sexp @>: Find string "dark" anywhere                                    22.319
sexp: Insert 200K AST-like expressions                                 132.269
jsonb: Insert 200K AST-like structures                                 300.805
sexp: Find all functions with "let" binding                             16.642
jsonb: Find all functions with "let" type                                5.142
sexp: Find functions with "cond" form                                   19.170
jsonb: Find functions with "cond" type                                  31.062
sexp: Find functions using multiplication (*)                           22.000
jsonb: Find functions using multiplication                               2.975
sexp: Count list operations (car) on AST                                 6.811
jsonb: Count type checks on AST                                          2.924
sexp: Insert 100K deeply nested (15 levels)                             45.289
jsonb: Insert 100K deeply nested (15 levels)                            38.551
sexp: Sequential scan of deeply nested data                              0.472
jsonb: Sequential scan of deeply nested data                             0.528
sexp: Find by deep containment                                           5.030
jsonb: Find by deep containment                                          5.203
Inserting 500K rows for GIN benchmark                                  238.483
sexp @>>: Containment WITHOUT GIN (seq scan)                            19.357
jsonb @>: Containment WITHOUT GIN (seq scan)                             5.117
Creating GIN indexes                                                   907.749
sexp @>>: GIN - Find click events (10% selectivity)                      3.914
jsonb @>: GIN - Find click events (10% selectivity)                      1.639
sexp @>>: GIN - Find chrome + windows                                    4.765
jsonb @>: GIN - Find chrome + windows                                    1.712
sexp @>>: GIN - Find mobile=true events                                  7.530
jsonb @>: GIN - Find mobile=true events                                  2.538
sexp @>>: GIN - Find event by ID (highly selective)                      0.129
jsonb @>: GIN - Find event by ID (highly selective)                      0.084
sexp @>>: GIN - Complex query (type=purchase AND mobile=true)            1.183
jsonb @>: GIN - Complex query (type=purchase AND mobile=true)            0.204
sexp @>: GIN - Find by tag symbol "important" (structural)               1.693
sexp @>: GIN - Find exact (type "click") sublist                         3.070
sexp: Serialize all 500K rows to text                                   75.197
jsonb: Serialize all 500K rows to text                                  91.187
sexp: car operation on 500K rows                                        22.770
sexp: cdr operation on 500K rows                                        58.546
sexp: sexp_length on 500K rows                                          11.321
sexp: nth access (element 3 = metadata) on 500K rows                    14.322
sexp: Deep nth access on 500K rows                                      28.644
sexp: Group by first-level element (using car of nth)                   38.865
jsonb: Group by first-level key                                         15.587

## GIN INDEX SIZES

 sexp_gin  | 17 MB
 jsonb_gin | 9824 kB

## AST STORAGE SIZES

 sexp_ast  | 6888 kB    | 6400 kB
 jsonb_ast | 27 MB      | 26 MB

## DEEP NESTING STORAGE SIZES

 sexp_deep  | 2848 kB    | 2576 kB
 jsonb_deep | 4488 kB    | 4216 kB

## PERFORMANCE COMPARISON (sexp vs jsonb)

Operation                                             sexp (ms)   jsonb (ms)      Ratio
-------------------------------------------------- ------------ ------------ ----------
Inserting 50,000 rows                                   325.362      318.274      0.98x
Full table scan with COUNT                                2.236        2.473      1.11x
Full table scan with SUM of data length                  30.716       40.770      1.33x
Access first element (car)                               12.426        4.018      0.32x
Access nested element (nth 2 = user info)                 8.474        4.603      0.54x
Deep nested access (user -> id) via car/cdr              25.477        5.506      0.22x
Insert 200K AST-like expressions                        132.269      300.805      2.27x
Find all functions with "let" binding                    16.642        5.142      0.31x
Find functions with "cond" form                          19.170       31.062      1.62x
Find functions using multiplication (*)                  22.000        2.975      0.14x
Count list operations (car) on AST                        6.811        2.924      0.43x
Insert 100K deeply nested (15 levels)                    45.289       38.551      0.85x
Sequential scan of deeply nested data                     0.472        0.528      1.12x
Find by deep containment                                  5.030        5.203      1.03x
Serialize all 500K rows to text                          75.197       91.187      1.21x
Group by first-level element (using car of nth)          38.865       15.587      0.40x

================================================================================
Full results: /home/gdiazlo/data/src/pg_sexp/test/results/benchmark_quick_20251207_003356.txt
================================================================================
