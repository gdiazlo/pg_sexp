================================================================================
pg_sexp Benchmark Summary
Generated: sÃ¡b 06 dic 2025 15:52:49 CET
Image: localhost/pg_sexp-production
================================================================================

## POSTGRESQL VERSION
PostgreSQL 18.1 on x86_64-pc-linux-musl, compiled by Alpine clang version 19.1.4, 64-bit

## STORAGE COMPARISON

 sexp  | 16 MB      | 15 MB      |     50000
 jsonb | 24 MB      | 23 MB      |     50000

 sexp  |           313
 jsonb |           481

## TIMING RESULTS

Test                                                                 Time (ms)
----------------------------------------------------------------- ------------
sexp: Inserting 50,000 rows                                            282.450
jsonb: Inserting 50,000 rows                                           276.526
sexp: Full table scan with COUNT                                         2.440
jsonb: Full table scan with COUNT                                        2.039
sexp: Full table scan with SUM of data length                           27.706
jsonb: Full table scan with SUM of data length                          38.329
sexp: Access first element (car)                                         7.057
jsonb: Access first-level key                                            3.882
sexp: Access nested element (nth 2 = user info)                          6.179
jsonb: Access nested element (user object)                               4.091
sexp: Deep nested access (user -> id) via car/cdr                       15.205
jsonb: Deep nested access (user -> id)                                   5.506
sexp @>>: Filter by settings.theme = dark (33% selectivity)             23.146
jsonb @>: Filter by settings.theme = dark (33% selectivity)              5.099
sexp @>>: Filter by user.id = 12345 (highly selective)                  25.503
jsonb @>: Filter by user.id = 12345 (highly selective)                   5.267
sexp @>>: Multi-condition (settings.theme=dark AND notifications=       27.447
jsonb @>: Multi-condition (settings.theme=dark AND notifications=        5.565
sexp @>: Find exact (theme "dark") sublist anywhere                     14.639
sexp @>: Find symbol alpha anywhere                                     15.861
sexp @>: Find string "dark" anywhere                                    12.508
sexp: Insert 200K AST-like expressions                                 110.152
jsonb: Insert 200K AST-like structures                                 301.656
sexp: Find all functions with "let" binding                              7.218
jsonb: Find all functions with "let" type                                4.580
sexp: Find functions with "cond" form                                   13.654
jsonb: Find functions with "cond" type                                  28.776
sexp: Find functions using multiplication (*)                           20.809
jsonb: Find functions using multiplication                               2.807
sexp: Count list operations (car) on AST                                 3.830
jsonb: Count type checks on AST                                          3.015
sexp: Insert 100K deeply nested (15 levels)                             42.722
jsonb: Insert 100K deeply nested (15 levels)                            39.028
sexp: Sequential scan of deeply nested data                              0.363
jsonb: Sequential scan of deeply nested data                             0.434
sexp: Find by deep containment                                          18.083
jsonb: Find by deep containment                                          5.158
Inserting 500K rows for GIN benchmark                                  215.162
sexp @>>: Containment WITHOUT GIN (seq scan)                            14.991
jsonb @>: Containment WITHOUT GIN (seq scan)                             5.346
Creating GIN indexes                                                   534.177
sexp @>>: GIN - Find click events (10% selectivity)                      2.471
jsonb @>: GIN - Find click events (10% selectivity)                      1.554
sexp @>>: GIN - Find chrome + windows                                    3.562
jsonb @>: GIN - Find chrome + windows                                    1.829
sexp @>>: GIN - Find mobile=true events                                  4.688
jsonb @>: GIN - Find mobile=true events                                  2.298
sexp @>>: GIN - Find event by ID (highly selective)                      0.124
jsonb @>: GIN - Find event by ID (highly selective)                      0.062
sexp @>>: GIN - Complex query (type=purchase AND mobile=true)            1.453
jsonb @>: GIN - Complex query (type=purchase AND mobile=true)            0.186
sexp @>: GIN - Find by tag symbol "important" (structural)               5.013
sexp @>: GIN - Find exact (type "click") sublist                         1.318
sexp: Serialize all 500K rows to text                                   35.435
jsonb: Serialize all 500K rows to text                                  48.283
sexp: car operation on 500K rows                                         7.436
sexp: cdr operation on 500K rows                                        27.063
sexp: sexp_length on 500K rows                                           4.440
sexp: nth access (element 3 = metadata) on 500K rows                     6.830
sexp: Deep nth access on 500K rows                                      10.382
sexp: Group by first-level element (using car of nth)                   10.618
jsonb: Group by first-level key                                         26.225

## GIN INDEX SIZES

 sexp_gin  | 11 MB
 jsonb_gin | 9824 kB

## AST STORAGE SIZES

 sexp_ast  | 5656 kB    | 5168 kB
 jsonb_ast | 27 MB      | 26 MB

## DEEP NESTING STORAGE SIZES

 sexp_deep  | 2632 kB    | 2360 kB
 jsonb_deep | 4488 kB    | 4216 kB

## PERFORMANCE COMPARISON (sexp vs jsonb)

Operation                                             sexp (ms)   jsonb (ms)      Ratio
-------------------------------------------------- ------------ ------------ ----------
Inserting 50,000 rows                                   282.450      276.526      0.98x
Full table scan with COUNT                                2.440        2.039      0.84x
Full table scan with SUM of data length                  27.706       38.329      1.38x
Access first element (car)                                7.057        3.882      0.55x
Access nested element (nth 2 = user info)                 6.179        4.091      0.66x
Deep nested access (user -> id) via car/cdr              15.205        5.506      0.36x
Insert 200K AST-like expressions                        110.152      301.656      2.74x
Find all functions with "let" binding                     7.218        4.580      0.63x
Find functions with "cond" form                          13.654       28.776      2.11x
Find functions using multiplication (*)                  20.809        2.807      0.13x
Count list operations (car) on AST                        3.830        3.015      0.79x
Insert 100K deeply nested (15 levels)                    42.722       39.028      0.91x
Sequential scan of deeply nested data                     0.363        0.434      1.20x
Find by deep containment                                 18.083        5.158      0.29x
Serialize all 500K rows to text                          35.435       48.283      1.36x
Group by first-level element (using car of nth)          10.618       26.225      2.47x

================================================================================
Full results: /home/gdiazlo/data/src/pg_sexp/test/results/benchmark_quick_20251206_155243.txt
================================================================================
