================================================================================
pg_sexp Benchmark Summary
Generated: sÃ¡b 06 dic 2025 15:52:20 CET
Image: localhost/pg_sexp-production
================================================================================

## POSTGRESQL VERSION
PostgreSQL 18.1 on x86_64-pc-linux-musl, compiled by Alpine clang version 19.1.4, 64-bit

## STORAGE COMPARISON

 sexp  | 16 MB      | 15 MB      |     50000
 jsonb | 24 MB      | 23 MB      |     50000

 sexp  |           313
 jsonb |           481

## TIMING RESULTS

Test                                                                 Time (ms)
----------------------------------------------------------------- ------------
sexp: Inserting 50,000 rows                                            303.974
jsonb: Inserting 50,000 rows                                           283.876
sexp: Full table scan with COUNT                                         3.398
jsonb: Full table scan with COUNT                                        3.037
sexp: Full table scan with SUM of data length                           27.877
jsonb: Full table scan with SUM of data length                          37.893
sexp: Access first element (car)                                         7.587
jsonb: Access first-level key                                            4.081
sexp: Access nested element (nth 2 = user info)                          7.123
jsonb: Access nested element (user object)                               4.706
sexp: Deep nested access (user -> id) via car/cdr                       16.637
jsonb: Deep nested access (user -> id)                                   5.545
sexp @>>: Filter by settings.theme = dark (33% selectivity)             24.201
jsonb @>: Filter by settings.theme = dark (33% selectivity)              5.752
sexp @>>: Filter by user.id = 12345 (highly selective)                  26.194
jsonb @>: Filter by user.id = 12345 (highly selective)                   5.646
sexp @>>: Multi-condition (settings.theme=dark AND notifications=       26.887
jsonb @>: Multi-condition (settings.theme=dark AND notifications=        6.098
sexp @>: Find exact (theme "dark") sublist anywhere                     17.601
sexp @>: Find symbol alpha anywhere                                     16.584
sexp @>: Find string "dark" anywhere                                    13.284
sexp: Insert 200K AST-like expressions                                 115.852
jsonb: Insert 200K AST-like structures                                 315.092
sexp: Find all functions with "let" binding                              7.893
jsonb: Find all functions with "let" type                                5.436
sexp: Find functions with "cond" form                                   13.758
jsonb: Find functions with "cond" type                                  30.015
sexp: Find functions using multiplication (*)                           19.477
jsonb: Find functions using multiplication                               3.282
sexp: Count list operations (car) on AST                                 4.569
jsonb: Count type checks on AST                                          3.555
sexp: Insert 100K deeply nested (15 levels)                             49.897
jsonb: Insert 100K deeply nested (15 levels)                            38.460
sexp: Sequential scan of deeply nested data                              0.530
jsonb: Sequential scan of deeply nested data                             0.579
sexp: Find by deep containment                                          16.792
jsonb: Find by deep containment                                          5.645
Inserting 500K rows for GIN benchmark                                  209.861
sexp @>>: Containment WITHOUT GIN (seq scan)                            15.839
jsonb @>: Containment WITHOUT GIN (seq scan)                             5.207
Creating GIN indexes                                                   571.904
sexp @>>: GIN - Find click events (10% selectivity)                      2.528
jsonb @>: GIN - Find click events (10% selectivity)                      1.647
sexp @>>: GIN - Find chrome + windows                                    3.771
jsonb @>: GIN - Find chrome + windows                                    1.925
sexp @>>: GIN - Find mobile=true events                                  4.955
jsonb @>: GIN - Find mobile=true events                                  2.617
sexp @>>: GIN - Find event by ID (highly selective)                      0.145
jsonb @>: GIN - Find event by ID (highly selective)                      0.071
sexp @>>: GIN - Complex query (type=purchase AND mobile=true)            1.517
jsonb @>: GIN - Complex query (type=purchase AND mobile=true)            0.203
sexp @>: GIN - Find by tag symbol "important" (structural)               5.458
sexp @>: GIN - Find exact (type "click") sublist                         1.644
sexp: Serialize all 500K rows to text                                   35.618
jsonb: Serialize all 500K rows to text                                  47.951
sexp: car operation on 500K rows                                         7.530
sexp: cdr operation on 500K rows                                        25.843
sexp: sexp_length on 500K rows                                           5.112
sexp: nth access (element 3 = metadata) on 500K rows                     7.677
sexp: Deep nth access on 500K rows                                      11.171
sexp: Group by first-level element (using car of nth)                   11.769
jsonb: Group by first-level key                                         29.754

## GIN INDEX SIZES

 sexp_gin  | 11 MB
 jsonb_gin | 9824 kB

## AST STORAGE SIZES

 sexp_ast  | 5656 kB    | 5168 kB
 jsonb_ast | 27 MB      | 26 MB

## DEEP NESTING STORAGE SIZES

 sexp_deep  | 2632 kB    | 2360 kB
 jsonb_deep | 4488 kB    | 4216 kB

## PERFORMANCE COMPARISON (sexp vs jsonb)

Operation                                             sexp (ms)   jsonb (ms)      Ratio
-------------------------------------------------- ------------ ------------ ----------
Inserting 50,000 rows                                   303.974      283.876      0.93x
Full table scan with COUNT                                3.398        3.037      0.89x
Full table scan with SUM of data length                  27.877       37.893      1.36x
Access first element (car)                                7.587        4.081      0.54x
Access nested element (nth 2 = user info)                 7.123        4.706      0.66x
Deep nested access (user -> id) via car/cdr              16.637        5.545      0.33x
Insert 200K AST-like expressions                        115.852      315.092      2.72x
Find all functions with "let" binding                     7.893        5.436      0.69x
Find functions with "cond" form                          13.758       30.015      2.18x
Find functions using multiplication (*)                  19.477        3.282      0.17x
Count list operations (car) on AST                        4.569        3.555      0.78x
Insert 100K deeply nested (15 levels)                    49.897       38.460      0.77x
Sequential scan of deeply nested data                     0.530        0.579      1.09x
Find by deep containment                                 16.792        5.645      0.34x
Serialize all 500K rows to text                          35.618       47.951      1.35x
Group by first-level element (using car of nth)          11.769       29.754      2.53x

================================================================================
Full results: /home/gdiazlo/data/src/pg_sexp/test/results/benchmark_quick_20251206_155213.txt
================================================================================
