================================================================================
pg_sexp Benchmark Summary
Generated: sÃ¡b 06 dic 2025 15:27:06 CET
Image: localhost/pg_sexp-production
================================================================================

## POSTGRESQL VERSION
PostgreSQL 18.1 on x86_64-pc-linux-musl, compiled by Alpine clang version 19.1.4, 64-bit

## STORAGE COMPARISON

 sexp  | 16 MB      | 15 MB      |     50000
 jsonb | 24 MB      | 23 MB      |     50000

 sexp  |           313
 jsonb |           481

## TIMING RESULTS

Test                                                                 Time (ms)
----------------------------------------------------------------- ------------
sexp: Inserting 50,000 rows                                            284.827
jsonb: Inserting 50,000 rows                                           301.490
sexp: Full table scan with COUNT                                         2.379
jsonb: Full table scan with COUNT                                        2.055
sexp: Full table scan with SUM of data length                           26.036
jsonb: Full table scan with SUM of data length                          33.135
sexp: Access first element (car)                                         7.246
jsonb: Access first-level key                                            3.938
sexp: Access nested element (nth 2 = user info)                          6.232
jsonb: Access nested element (user object)                               4.024
sexp: Deep nested access (user -> id) via car/cdr                       14.278
jsonb: Deep nested access (user -> id)                                   5.270
sexp @>>: Filter by settings.theme = dark (33% selectivity)             17.129
jsonb @>: Filter by settings.theme = dark (33% selectivity)              5.008
sexp @>>: Filter by user.id = 12345 (highly selective)                  17.749
jsonb @>: Filter by user.id = 12345 (highly selective)                   5.336
sexp @>>: Multi-condition (settings.theme=dark AND notifications=       17.005
jsonb @>: Multi-condition (settings.theme=dark AND notifications=        5.266
sexp @>: Find exact (theme "dark") sublist anywhere                     14.600
sexp @>: Find symbol alpha anywhere                                     14.915
sexp @>: Find string "dark" anywhere                                    13.008
sexp: Insert 200K AST-like expressions                                 115.681
jsonb: Insert 200K AST-like structures                                 289.985
sexp: Find all functions with "let" binding                              7.527
jsonb: Find all functions with "let" type                                5.022
sexp: Find functions with "cond" form                                   13.852
jsonb: Find functions with "cond" type                                  29.022
sexp: Find functions using multiplication (*)                           20.650
jsonb: Find functions using multiplication                               2.769
sexp: Count list operations (car) on AST                                 3.900
jsonb: Count type checks on AST                                          2.926
sexp: Insert 100K deeply nested (15 levels)                             44.135
jsonb: Insert 100K deeply nested (15 levels)                            34.905
sexp: Sequential scan of deeply nested data                              0.362
jsonb: Sequential scan of deeply nested data                             0.737
sexp: Find by deep containment                                          17.980
jsonb: Find by deep containment                                          5.188
Inserting 500K rows for GIN benchmark                                  220.563
sexp @>>: Containment WITHOUT GIN (seq scan)                            10.816
jsonb @>: Containment WITHOUT GIN (seq scan)                             4.826
Creating GIN indexes                                                   532.602
sexp @>>: GIN - Find click events (10% selectivity)                      2.411
jsonb @>: GIN - Find click events (10% selectivity)                      1.540
sexp @>>: GIN - Find chrome + windows                                    3.218
jsonb @>: GIN - Find chrome + windows                                    2.004
sexp @>>: GIN - Find mobile=true events                                  4.067
jsonb @>: GIN - Find mobile=true events                                  2.293
sexp @>>: GIN - Find event by ID (highly selective)                      0.123
jsonb @>: GIN - Find event by ID (highly selective)                      0.062
sexp @>>: GIN - Complex query (type=purchase AND mobile=true)            1.451
jsonb @>: GIN - Complex query (type=purchase AND mobile=true)            0.184
sexp @>: GIN - Find by tag symbol "important" (structural)               5.116
sexp @>: GIN - Find exact (type "click") sublist                         1.483
sexp: Serialize all 500K rows to text                                   33.523
jsonb: Serialize all 500K rows to text                                  42.757
sexp: car operation on 500K rows                                         6.989
sexp: cdr operation on 500K rows                                        25.192
sexp: sexp_length on 500K rows                                           4.102
sexp: nth access (element 3 = metadata) on 500K rows                     6.483
sexp: Deep nth access on 500K rows                                       9.874
sexp: Group by first-level element (using car of nth)                   10.654
jsonb: Group by first-level key                                         27.307

## GIN INDEX SIZES

 sexp_gin  | 11 MB
 jsonb_gin | 9824 kB

## AST STORAGE SIZES

 sexp_ast  | 5656 kB    | 5168 kB
 jsonb_ast | 27 MB      | 26 MB

## DEEP NESTING STORAGE SIZES

 sexp_deep  | 2632 kB    | 2360 kB
 jsonb_deep | 4488 kB    | 4216 kB

## PERFORMANCE COMPARISON (sexp vs jsonb)

Operation                                             sexp (ms)   jsonb (ms)      Ratio
-------------------------------------------------- ------------ ------------ ----------
Inserting 50,000 rows                                   284.827      301.490      1.06x
Full table scan with COUNT                                2.379        2.055      0.86x
Full table scan with SUM of data length                  26.036       33.135      1.27x
Access first element (car)                                7.246        3.938      0.54x
Access nested element (nth 2 = user info)                 6.232        4.024      0.65x
Deep nested access (user -> id) via car/cdr              14.278        5.270      0.37x
Insert 200K AST-like expressions                        115.681      289.985      2.51x
Find all functions with "let" binding                     7.527        5.022      0.67x
Find functions with "cond" form                          13.852       29.022      2.10x
Find functions using multiplication (*)                  20.650        2.769      0.13x
Count list operations (car) on AST                        3.900        2.926      0.75x
Insert 100K deeply nested (15 levels)                    44.135       34.905      0.79x
Sequential scan of deeply nested data                     0.362        0.737      2.04x
Find by deep containment                                 17.980        5.188      0.29x
Serialize all 500K rows to text                          33.523       42.757      1.28x
Group by first-level element (using car of nth)          10.654       27.307      2.56x

================================================================================
Full results: /home/gdiazlo/data/src/pg_sexp/test/results/benchmark_quick_20251206_152700.txt
================================================================================
